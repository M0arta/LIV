% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/liv_analysis.R
\name{run_LIV_for_outcome}
\alias{run_LIV_for_outcome}
\title{Run LIV Analysis for a Given Outcome with Diagnostics}
\usage{
run_LIV_for_outcome(
  outcome_var,
  data,
  treatment_var,
  instrument_var,
  covariates,
  fixed_effects,
  R = 1000,
  seed = 123,
  bw = 0.05,
  kernel = "epanechnikov",
  epsilon = 0.001,
  perform_diagnostics = FALSE,
  diagnostic_methods = c("default", "cv.aic", "cv.ls"),
  workers = NULL
)
}
\arguments{
\item{outcome_var}{A string specifying the name of the outcome variable (e.g., "Y").}

\item{data}{A data frame containing the dataset with necessary variables.}

\item{treatment_var}{A string specifying the name of the treatment variable (e.g., "D").}

\item{instrument_var}{A string specifying the name of the instrument variable (e.g., "Z").}

\item{covariates}{A string vector specifying the names of covariate variables.}

\item{fixed_effects}{A string vector specifying the names of fixed effect variables.}

\item{R}{Number of bootstrap replications. Default is \code{1000}.}

\item{seed}{Random seed for bootstrapping. Default is \code{123}.}

\item{bw}{Bandwidth for non-parametric regression. Default is \code{0.05}.}

\item{kernel}{Kernel type for non-parametric regression. Options include \code{"epanechnikov"}, \code{"gaussian"}, etc. Default is \code{"epanechnikov"}.}

\item{epsilon}{Threshold for filtering residualized treatment. Default is \code{1e-3}.}

\item{perform_diagnostics}{Logical indicating whether to perform bandwidth selection and gradient diagnostics. Default is \code{FALSE}.}

\item{diagnostic_methods}{A character vector specifying bandwidth selection methods for diagnostics. Default is \code{c("default", "cv.aic", "cv.ls")}.}

\item{workers}{Number of parallel workers for bootstrapping. Default is the number of available cores.}
}
\value{
A list containing:
\item{outcome}{Name of the outcome variable.}
\item{model_Y}{The fitted fixed effects model for the outcome variable.}
\item{LIV_estimates}{Vector of LIV estimates over the instrument grid.}
\item{instrument_grid}{Numeric vector of instrument grid points.}
\item{ci_lower}{Lower bounds of the 95\% confidence intervals for LIV estimates.}
\item{ci_upper}{Upper bounds of the 95\% confidence intervals for LIV estimates.}
\item{plot}{A ggplot object visualizing the LIV curve with confidence intervals.}
\item{diagnostics}{A list containing diagnostic plots if \code{perform_diagnostics = TRUE}.}
}
\description{
Performs the complete Local Instrumental Variable (LIV) analysis pipeline for a specified outcome variable, including optional bandwidth selection and gradient diagnostics.
}
\examples{
\dontrun{
results <- run_LIV_for_outcome(
  outcome_var = "hours",
  data = mroz_data,
  treatment_var = "wage",
  instrument_var = "kids",
  covariates = c("age", "educ", "married"),
  fixed_effects = c("region"),
  R = 1000,
  seed = 123,
  bw = 0.05,
  kernel = "epanechnikov",
  epsilon = 1e-3,
  perform_diagnostics = TRUE,
  diagnostic_methods = c("default", "cv.aic", "cv.ls"),
  workers = 4
)

# Plot the LIV curve
print(results$plot)

# View diagnostic histograms
print(results$diagnostics$histograms$hist_default)
print(results$diagnostics$histograms$hist_cv.aic)
print(results$diagnostics$histograms$hist_cv.ls)

# View diagnostic scatter plots
print(results$diagnostics$scatter_plots$scatter_default)
print(results$diagnostics$scatter_plots$scatter_cv.aic)
print(results$diagnostics$scatter_plots$scatter_cv.ls)
}
}
